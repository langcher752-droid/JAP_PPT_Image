# æ—¥è¯­è¯æ±‡PPTå›¾ç‰‡å¢å¼ºå·¥å…· - Webéƒ¨ç½²è¯´æ˜

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GitHub Pages   â”‚  â”€â”€â”€â”€> â”‚   ä½ çš„æœåŠ¡å™¨      â”‚
â”‚  (å‰ç«¯é¡µé¢)     â”‚         â”‚  (åç«¯API)       â”‚
â”‚  index.html     â”‚         â”‚  web_app.py      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **å‰ç«¯**ï¼šéƒ¨ç½²åœ¨GitHub Pagesï¼ˆå…è´¹ï¼Œé™æ€é¡µé¢ï¼‰
- **åç«¯**ï¼šéƒ¨ç½²åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šï¼ˆéœ€è¦è¿è¡ŒPythonï¼‰

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åç«¯APIåˆ°ä½ çš„æœåŠ¡å™¨

#### 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

å°†ä»¥ä¸‹æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼š
- `web_app.py` - Web APIæœåŠ¡å™¨
- `main.py` - æ ¸å¿ƒå¤„ç†é€»è¾‘
- `config.json` - APIé…ç½®ï¼ˆåŒ…å«Googleå’ŒSpark APIå¯†é’¥ï¼‰
- `requirements-web.txt` - Pythonä¾èµ–

#### 2. å®‰è£…ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/your/project

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements-web.txt
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œæ›´å®‰å…¨ï¼‰

åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®ç¯å¢ƒå˜é‡ï¼Œè€Œä¸æ˜¯åœ¨config.jsonä¸­ç¡¬ç¼–ç ï¼š

```bash
export GOOGLE_API_KEY="your_google_api_key"
export GOOGLE_CSE_ID="your_cse_id"
export SPARK_API_KEY="your_spark_api_key"
export SPARK_BASE_URL="https://spark-api-open.xf-yun.com/v2"
export SPARK_MODEL="spark-x"
```

#### 4. è¿è¡ŒæœåŠ¡å™¨

**å¼€å‘ç¯å¢ƒï¼ˆæµ‹è¯•ç”¨ï¼‰ï¼š**
```bash
python web_app.py
```

**ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èä½¿ç”¨gunicornï¼‰ï¼š**
```bash
gunicorn -w 4 -b 0.0.0.0:5000 web_app:app
```

**ä½¿ç”¨systemdç®¡ç†æœåŠ¡ï¼ˆLinuxï¼‰ï¼š**

åˆ›å»º `/etc/systemd/system/ppt-enhancer.service`ï¼š

```ini
[Unit]
Description=PPT Image Enhancer API
After=network.target

[Service]
User=your_username
WorkingDirectory=/path/to/your/project
Environment="PATH=/path/to/your/project/venv/bin"
ExecStart=/path/to/your/project/venv/bin/gunicorn -w 4 -b 0.0.0.0:5000 web_app:app
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
sudo systemctl start ppt-enhancer
sudo systemctl enable ppt-enhancer  # å¼€æœºè‡ªå¯
```

#### 5. é…ç½®Nginxåå‘ä»£ç†ï¼ˆå¯é€‰ä½†æ¨èï¼‰

åˆ›å»º `/etc/nginx/sites-available/ppt-enhancer`ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    client_max_body_size 100M;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/ppt-enhancer /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

#### 6. é…ç½®HTTPSï¼ˆæ¨èï¼‰

ä½¿ç”¨Let's Encryptå…è´¹SSLè¯ä¹¦ï¼š
```bash
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```

---

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ°GitHub Pages

#### 1. åˆ›å»ºGitHubä»“åº“

1. åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªæ–°ä»“åº“ï¼ˆä¾‹å¦‚ï¼š`ppt-image-enhancer-web`ï¼‰
2. è®¾ç½®ä¸ºå…¬å¼€ï¼ˆPublicï¼‰ä»¥ä½¿ç”¨GitHub Pageså…è´¹ç‰ˆ

#### 2. ä¸Šä¼ å‰ç«¯æ–‡ä»¶

å°† `web/index.html` ä¸Šä¼ åˆ°ä»“åº“æ ¹ç›®å½•

#### 3. ä¿®æ”¹APIåœ°å€

ç¼–è¾‘ `index.html`ï¼Œæ‰¾åˆ°è¿™ä¸€è¡Œï¼š
```javascript
value="http://localhost:5000"
```

æ”¹ä¸ºä½ çš„æœåŠ¡å™¨åœ°å€ï¼š
```javascript
value="https://your-domain.com"  // æˆ–ä½ çš„æœåŠ¡å™¨IP
```

#### 4. å¯ç”¨GitHub Pages

1. è¿›å…¥ä»“åº“è®¾ç½®ï¼ˆSettingsï¼‰
2. æ‰¾åˆ° "Pages" é€‰é¡¹
3. é€‰æ‹© Source: `main` branchï¼ˆæˆ–ä½ çš„ä¸»åˆ†æ”¯ï¼‰
4. ä¿å­˜

#### 5. è®¿é—®ä½ çš„ç½‘ç«™

å‡ åˆ†é’Ÿåï¼Œä½ çš„ç½‘ç«™å°±å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š
```
https://your-username.github.io/ppt-image-enhancer-web/
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### APIæœåŠ¡å™¨åœ°å€é…ç½®

ç”¨æˆ·å¯ä»¥åœ¨å‰ç«¯é¡µé¢ç›´æ¥ä¿®æ”¹APIæœåŠ¡å™¨åœ°å€ï¼Œåœ°å€ä¼šä¿å­˜åœ¨æµè§ˆå™¨çš„localStorageä¸­ã€‚

### å®‰å…¨å»ºè®®

1. **ä½¿ç”¨HTTPS**ï¼šç¡®ä¿APIæœåŠ¡å™¨ä½¿ç”¨HTTPSï¼Œä¿æŠ¤ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶
2. **APIå¯†é’¥ä¿æŠ¤**ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡è€Œä¸æ˜¯config.jsonå­˜å‚¨å¯†é’¥
3. **æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šé»˜è®¤100MBï¼Œå¯åœ¨`web_app.py`ä¸­ä¿®æ”¹`MAX_FILE_SIZE`
4. **å®šæœŸæ¸…ç†**ï¼šå¯ä»¥è®¾ç½®å®šæ—¶ä»»åŠ¡è°ƒç”¨`/api/cleanup`æ¥å£æ¸…ç†æ—§æ–‡ä»¶

### å®šæ—¶æ¸…ç†ä»»åŠ¡ï¼ˆå¯é€‰ï¼‰

åˆ›å»ºcronä»»åŠ¡è‡ªåŠ¨æ¸…ç†æ—§æ–‡ä»¶ï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹æ¸…ç†ï¼‰
0 2 * * * curl -X POST http://localhost:5000/api/cleanup
```

---

## ğŸ“ APIæ¥å£è¯´æ˜

### 1. å¥åº·æ£€æŸ¥
```
GET /api/health
```
è¿”å›æœåŠ¡å™¨çŠ¶æ€å’ŒAPIé…ç½®æƒ…å†µ

### 2. å¤„ç†PPT
```
POST /api/process
Content-Type: multipart/form-data

å‚æ•°ï¼š
- file: PPTæ–‡ä»¶ï¼ˆ.pptxæˆ–.pptï¼‰

è¿”å›ï¼š
{
  "status": "success",
  "task_id": "uuid",
  "message": "å¤„ç†å®Œæˆ",
  "output_filename": "xxx_enhanced.pptx",
  "logs": [...]
}
```

### 3. ä¸‹è½½å¤„ç†åçš„PPT
```
GET /api/download/<task_id>
```
è¿”å›å¤„ç†åçš„PPTæ–‡ä»¶

### 4. æ¸…ç†æ—§æ–‡ä»¶
```
POST /api/cleanup
```
æ¸…ç†è¶…è¿‡1å°æ—¶çš„ä¸Šä¼ æ–‡ä»¶å’Œè¶…è¿‡24å°æ—¶çš„è¾“å‡ºæ–‡ä»¶

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šæ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨

- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œï¼š`curl http://localhost:5000/api/health`
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾5000ç«¯å£
- æ£€æŸ¥Nginxé…ç½®æ˜¯å¦æ­£ç¡®

### é—®é¢˜2ï¼šæ–‡ä»¶ä¸Šä¼ å¤±è´¥

- æ£€æŸ¥`MAX_FILE_SIZE`è®¾ç½®
- æ£€æŸ¥Nginxçš„`client_max_body_size`é…ç½®
- æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³

### é—®é¢˜3ï¼šå¤„ç†å¤±è´¥

- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼š`journalctl -u ppt-enhancer -f`
- æ£€æŸ¥APIå¯†é’¥é…ç½®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶å¤¹æƒé™

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨æ—¥å¿—
2. æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
3. APIå¥åº·æ£€æŸ¥æ¥å£è¿”å›çš„ä¿¡æ¯

---

## ğŸ‰ å®Œæˆï¼

éƒ¨ç½²å®Œæˆåï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡GitHub Pagesè®¿é—®ä½ çš„ç½‘ç«™ï¼Œä¸Šä¼ PPTæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨å¤„ç†å¹¶è¿”å›å¢å¼ºåçš„PPTã€‚

