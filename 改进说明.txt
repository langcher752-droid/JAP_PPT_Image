日语词汇PPT图片增强工具 - 改进说明
=====================================

本次更新主要解决了两个问题：

1. PPT排版和文字可读性问题
2. 图片搜索关键词优化问题

=====================================
改进内容
=====================================

【问题1：PPT排版和文字可读性】

改进措施：
1. 文字框设计优化
   - 添加双层背景：黑色半透明背景层 + 白色主背景层
   - 增大字体：从36pt提升到40pt
   - 加粗边框：从3pt提升到4pt，使用深灰色提高对比度
   - 降低透明度：默认透明度从25%降低到15%，提高文字清晰度
   - 优化文字颜色：使用深灰色（RGB 20,20,20）而非纯黑，更柔和但依然清晰

2. 布局模板优化
   - 调整了多个模板中文字框的位置和大小
   - 优化了文字框与图片的重叠区域，避免颜色冲突
   - 降低了文字框的透明度，确保文字在任何背景下都清晰可见

【问题2：图片搜索关键词优化】

改进措施：
1. 集成Spark AI API
   - 使用Spark AI根据日语词汇生成优化的图片搜索关键词
   - 自动将日语词汇转换为适合图片搜索的中文或英文关键词
   - 关键词长度限制在10个字以内，确保搜索效果

2. 搜索策略优化
   - 优先使用Spark AI优化的关键词进行搜索
   - 如果优化失败，回退到原始关键词搜索
   - 保持原有的Google API和备用搜索方案

=====================================
配置说明
=====================================

需要在config.json中添加Spark AI配置：

{
  "google_api_key": "您的Google API密钥",
  "google_cse_id": "您的Google CSE ID",
  "spark_api_key": "您的Spark AI API密钥（格式：AK:SK 或 APIPassword）",
  "spark_base_url": "https://spark-api-open.xf-yun.com/v2",
  "spark_model": "spark-x"
}

Spark AI API密钥获取：
- 访问科大讯飞开放平台
- 创建应用并获取API密钥
- 支持两种格式：
  1. APIPassword（推荐）
  2. AK:SK格式

=====================================
使用说明
=====================================

1. 确保config.json中已配置Spark AI API密钥
2. 运行程序（命令行或GUI版本）
3. 程序会自动：
   - 使用Spark AI优化每个日语词汇的搜索关键词
   - 使用优化后的关键词搜索相关图片
   - 应用改进后的布局模板，确保文字清晰可见

=====================================
技术细节
=====================================

文字框改进：
- 双层背景设计：底层黑色半透明（40%透明度）+ 上层白色（15%透明度）
- 确保文字在任何图片背景下都清晰可见
- 边框加粗并使用深灰色，提高视觉对比度

Spark AI集成：
- 使用OpenAI兼容接口调用Spark AI
- 提示词设计：要求AI生成不超过10个字的图片搜索关键词
- 自动清理AI返回结果，提取纯关键词
- 失败时自动回退到原始关键词搜索

=====================================
注意事项
=====================================

1. Spark AI API需要网络连接
2. 如果Spark AI API调用失败，程序会自动使用原始关键词搜索
3. 文字框的改进会略微增加PPT文件大小（因为添加了额外的背景层）
4. 建议在使用前测试Spark AI API配置是否正确

=====================================
版本信息
=====================================

更新日期：2025年
主要改进：
- 添加Spark AI API集成
- 优化文字框设计和布局
- 改进图片搜索关键词生成

